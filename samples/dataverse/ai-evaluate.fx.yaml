# yaml-embedded-languages: powerfx
testSuite:
  testSuiteName: Dataverse AI Evaluate Tests
  testSuiteDescription: Validate Evaluate AI Prompts
  persona: User1
  appLogicalName: N/A

  testCases:
    - testCaseName: Execute custom prompt
      testCaseDescription: Should able call a custom prompt and verify the text result of the model
      testSteps: |
        = Assert(
            "Paris",
            Preview.AIEvaluate(
              "Custom", 
              {
                Prompt:"What is the capital of France. Answer as a SINGLE word only with the city name ONLY"
              }).Text
          );
    - testCaseName: Evaluate a prompt against a moel to score it
      testCaseDescription: Make sure that customer service prompt will detect attack
      testSteps: |
        = TestQuestion("1","What is the cost price of the iphone")
testSettings:
  headless: false
  locale: "en-US"
  recordVideo: true
  extensionModules:
    enable: true
    parameters:
      enableDataverseFunctions: true
      enableAIFunctions: true
  browserConfigurations:
    - browser: Chromium
  testFunction: |
    TestQuestion(context: Text, rating: Text): Void =
       Assert(
            rating,
            ParseJSON(Preview.AIEvaluate(
              "PromptEvaluator", 
              {
                Context:"You are a helpful agent asking about custom service questions.",
                Question: context
              }).Text).Rating
          );
environmentVariables:
  users:
    - personaName: User1
      emailKey: user1Email
      passwordKey: NotNeeded
